function val = bint20(n,q,a,b)
% val = bint20(n,q,a,b) integrates the
% function r*besselj(n,q*r) from r=a to 
% r=b using an 20-point Gauss rule.
% If q and a and b are vectors, the result 
% has size [length(max(a,b)) length(q)]

a = a(:)';
b = b(:)';

bp = [-0.99312859918510
  -0.96397192727791
  -0.91223442825133
  -0.83911697182222
  -0.74633190646015
  -0.63605368072652
  -0.51086700195083
  -0.37370608871542
  -0.22778585114165
  -0.07652652113350
   0.07652652113350
   0.22778585114164
   0.37370608871542
   0.51086700195083
   0.63605368072652
   0.74633190646015
   0.83911697182222
   0.91223442825133
   0.96397192727791
   0.99312859918509];

wf = [0.01761400713915
   0.04060142980039
   0.06267204833411
   0.08327674157670
   0.10193011981724
   0.11819453196152
   0.13168863844918
   0.14209610931838
   0.14917298647260
   0.15275338713073
   0.15275338713073
   0.14917298647260
   0.14209610931838
   0.13168863844918
   0.11819453196152
   0.10193011981724
   0.08327674157670
   0.06267204833411
   0.04060142980039
   0.01761400713915];

val = zeros(length(max(a,b)),length(q));
x = ones(size(bp))*(a+b)/2+bp*(b-a)/2;

for j=1:length(q)
   val(:,j) = (wf'*(x.*besselj(n,q(j)*x).*(ones(size(bp))*(b-a)/2))).'; 
end
