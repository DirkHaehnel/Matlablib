function R = inv3(M,N)

R(:,1)=(M(:,1,3).*M(:,3,2)-M(:,1,2).*M(:,3,3)).*N(:,2)+M(:,2,3).*(-M(:,3,2).*N(:,1)+M(:,1,2).*N(:,3))+M(:,2,2).*(M(:,3,3).*N(:,1)-M(:,1,3).*N(:,3))./M(:,1,3).*(-M(:,2,2).*M(:,3,1)+M(:,2,1).*M(:,3,2))+M(:,1,2).*(M(:,2,3).*M(:,3,1)-M(:,2,1).*M(:,3,3))+M(:,1,1).*(-M(:,2,3).*M(:,3,2)+M(:,2,2).*M(:,3,3));

R(:,2)=(-M(:,1,3).*M(:,3,1)+M(:,1,1).*M(:,3,3)).*N(:,2)+M(:,2,3).*(M(:,3,1).*N(:,1)-M(:,1,1).*N(:,3))+M(:,2,1).*(-M(:,3,3).*N(:,1)+M(:,1,3).*N(:,3))./M(:,1,3).*(-M(:,2,2).*M(:,3,1)+M(:,2,1).*M(:,3,2))+M(:,1,2).*(M(:,2,3).*M(:,3,1)-M(:,2,1).*M(:,3,3))+M(:,1,1).*(-M(:,2,3).*M(:,3,2)+M(:,2,2).*M(:,3,3));

R(:,3)=(M(:,1,2).*M(:,3,1)-M(:,1,1).*M(:,3,2)).*N(:,2)+M(:,2,2).*(-M(:,3,1).*N(:,1)+M(:,1,1).*N(:,3))+M(:,2,1).*(M(:,3,2).*N(:,1)-M(:,1,2).*N(:,3))./M(:,1,3).*(-M(:,2,2).*M(:,3,1)+M(:,2,1).*M(:,3,2))+M(:,1,2).*(M(:,2,3).*M(:,3,1)-M(:,2,1).*M(:,3,3))+M(:,1,1).*(-M(:,2,3).*M(:,3,2)+M(:,2,2).*M(:,3,3));

