function M = RotoDiffMatrix(al)

% This function calculates the coefficients for the theta-correlators upt
% to fourth order
%
% M{n} refers to the n-th order correlator <cos(\Theta)^n>
%
% index order: (l,m,s+1,k+1)


M{1} = zeros(2,3,2,2);
M{2} = zeros(3,5,3,3);
M{3} = zeros(4,7,4,4);
M{4} = zeros(5,9,5,5);


M{1}(:,:,2,1) = [[0, 0, 0]; [-cos(al)/2, -sin(al), cos(al)/2]];

M{2}(:,:,1,1) = [[0, 0, 1/3, 0, 0]; [0, 0, 0, 0, 0]; [-1/12*cos(al)^2, -1/3*cos(al)*sin(al), 1/12*(-1 + 3*cos(2*al)), 1/3*cos(al)*sin(al), -1/12*cos(al)^2]];

M{2}(:,:,3,1) = [[0, 0, 1/3, 0, 0]; [0, 0, 0, 0, 0]; [cos(al)^2/6, 2/3*cos(al)*sin(al), 1/6*(1 - 3*cos(2*al)), -2/3*cos(al)*sin(al), cos(al)^2/6]];

M{3}(:,:,2,1) = [[0, 0, 0, 0, 0, 0, 0]; [0, 0, -cos(al)/10, -sin(al)/5, cos(al)/10, 0, 0]; [0, 0, 0, 0, 0, 0, 0]; [cos(al)^3/40, 3/20*cos(al)^2*sin(al), -3/80*cos(al)*(-3 + 5*cos(2*al)), -1/20*(1 + 5*cos(2*al))*sin(al), 3/80*cos(al)*(-3 + 5*cos(2*al)), 3/20*cos(al)^2*sin(al), -1/40*cos(al)^3]];

M{3}(:,:,4,1) = [[0, 0, 0, 0, 0, 0, 0]; [0, 0, -3*cos(al)/10, -3*sin(al)/5, 3*cos(al)/10, 0, 0]; [0, 0, 0, 0, 0, 0, 0]; [-1/20*cos(al)^3, -3/10*cos(al)^2*sin(al), 3/40*cos(al)*(-3 + 5*cos(2*al)), 1/10*(1 + 5*cos(2*al))*sin(al), -3/40*cos(al)*(-3 + 5*cos(2*al)), -3/10*cos(al)^2*sin(al), cos(al)^3/20]];

M{4}(:,:,1,1) = [[0, 0, 0, 0, 1/5, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, -1/14*cos(al)^2, -1/7*sin(2*al), 1/14*(-1 + 3*cos(2*al)), 1/7*sin(2*al), -1/14*cos(al)^2, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [3*cos(al)^4/560, 3/70*cos(al)^3*sin(al), -3/280*cos(al)^2*(-5 + 7*cos(2*al)), -3/280*(-1 + 7*cos(2*al))*sin(2*al), 3*(9 - 20*cos(2*al) + 35*cos(4*al))/2240, 3/280*(-1 + 7*cos(2*al))*sin(2*al), -3/280*cos(al)^2*(-5 + 7*cos(2*al)), -3/70*cos(al)^3*sin(al), 3*cos(al)^4/560]];

M{4}(:,:,3,1) = [[0, 0, 0, 0, 1/15, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, cos(al)^2/84, 1/42*sin(2*al), 1/84*(1 - 3*cos(2*al)), -1/42*sin(2*al), cos(al)^2/84, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [-1/140*cos(al)^4, -2/35*cos(al)^3*sin(al), 1/70*cos(al)^2*(-5 + 7*cos(2*al)), 1/70*(-1 + 7*cos(2*al))*sin(2*al), 1/560*(-9 + 20*cos(2*al) - 35*cos(4*al)), -1/70*(-1 + 7*cos(2*al))*sin(2*al), 1/70*cos(al)^2*(-5 + 7*cos(2*al)), 2/35*cos(al)^3*sin(al), -1/140*cos(al)^4]];

M{4}(:,:,5,1) = [[0, 0, 0, 0, 1/5, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, cos(al)^2/7, 2/7*sin(2*al), 1/7*(1 - 3*cos(2*al)), -4/7*cos(al)*sin(al), cos(al)^2/7, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [cos(al)^4/70, 4/35*cos(al)^3*sin(al), -1/35*cos(al)^2*(-5 + 7*cos(2*al)), -1/35*(-1 + 7*cos(2*al))*sin(2*al), 1/280*(9 - 20*cos(2*al) + 35*cos(4*al)), 1/35*(-1 + 7*cos(2*al))*sin(2*al), -1/35*cos(al)^2*(-5 + 7*cos(2*al)), -4/35*cos(al)^3*sin(al), cos(al)^4/70]];

M{1}(:,:,1,2) = [[0, 0, 0]; [-cos(al)/2, -sin(al), cos(al)/2]];

M{2}(:,:,2,2) = [[0, 0, 0, 0, 0]; [0, 0, 0, 0, 0]; [cos(al)^2/8, 1/4*sin(2*al), 1/8*(1 - 3*cos(2*al)), -1/4*sin(2*al), cos(al)^2/8]];

M{3}(:,:,1,2) = [[0, 0, 0, 0, 0, 0, 0]; [0, 0, -3*cos(al)/10, -3*sin(al)/5, 3*cos(al)/10, 0, 0]; [0, 0, 0, 0, 0, 0, 0]; [cos(al)^3/40, 3/20*cos(al)^2*sin(al), 3/160*(cos(al) - 5*cos(3*al)), -1/20*(1 + 5*cos(2*al))*sin(al), 3/80*cos(al)*(-3 + 5*cos(2*al)), 3/20*cos(al)^2*sin(al), -1/40*cos(al)^3]];

M{3}(:,:,3,2) = [[0, 0, 0, 0, 0, 0, 0]; [0, 0, -cos(al)/10, -sin(al)/5, cos(al)/10, 0, 0]; [0, 0, 0, 0, 0, 0, 0]; [-1/30*cos(al)^3, -1/5*cos(al)^2*sin(al), 1/20*cos(al)*(-3 + 5*cos(2*al)), 1/15*(1 + 5*cos(2*al))*sin(al), -1/20*cos(al)*(-3 + 5*cos(2*al)), -1/5*cos(al)^2*sin(al), cos(al)^3/30]];

M{4}(:,:,2,2) = [[0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 3*cos(al)^2/56, 3/28*sin(2*al), 3/56*(1 - 3*cos(2*al)), -3/28*sin(2*al), 3*cos(al)^2/56, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [-3/448*cos(al)^4, -3/56*cos(al)^3*sin(al), 3/224*cos(al)^2*(-5 + 7*cos(2*al)), 3/448*(-2*sin(2*al) + 7*sin(4*al)), -3*(9 - 20*cos(2*al) + 35*cos(4*al))/1792, 3/448*(2*sin(2*al) - 7*sin(4*al)), 3/224*cos(al)^2*(-5 + 7*cos(2*al)), 3/56*cos(al)^3*sin(al), -3/448*cos(al)^4]];

M{4}(:,:,4,2) = [[0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 3*cos(al)^2/56, 3/28*sin(2*al), 3/56*(1 - 3*cos(2*al)), -3/28*sin(2*al), 3*cos(al)^2/56, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [cos(al)^4/112, 1/14*cos(al)^3*sin(al), -1/56*cos(al)^2*(-5 + 7*cos(2*al)), -1/56*(-1 + 7*cos(2*al))*sin(2*al), 1/448*(9 - 20*cos(2*al) + 35*cos(4*al)), 1/56*(-1 + 7*cos(2*al))*sin(2*al), -1/56*cos(al)^2*(-5 + 7*cos(2*al)), -1/14*cos(al)^3*sin(al), cos(al)^4/112]];

M{2}(:,:,1,3) = [[0, 0, 0, 0, 0]; [0, 0, 0, 0, 0]; [cos(al)^2/4, cos(al)*sin(al), 1/4*(1 - 3*cos(2*al)), -cos(al)*sin(al), cos(al)^2/4]];

M{3}(:,:,2,3) = [[0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0]; [-1/24*cos(al)^3, -1/4*cos(al)^2*sin(al), 1/32*(-cos(al) + 5*cos(3*al)), 1/24*(-3*sin(al) + 5*sin(3*al)), 1/32*(cos(al) - 5*cos(3*al)), -1/4*cos(al)^2*sin(al), cos(al)^3/24]];

M{4}(:,:,1,3) = [[0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 3*cos(al)^2/14, 3/7*sin(2*al), -3/14*(-1 + 3*cos(2*al)), -3/7*sin(2*al), 3*cos(al)^2/14, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [-1/112*cos(al)^4, -1/14*cos(al)^3*sin(al), 1/56*cos(al)^2*(-5 + 7*cos(2*al)), 1/56*(-1 + 7*cos(2*al))*sin(2*al), 1/448*(-9 + 20*cos(2*al) - 35*cos(4*al)), -1/56*(-1 + 7*cos(2*al))*sin(2*al), 1/56*cos(al)^2*(-5 + 7*cos(2*al)), 1/14*cos(al)^3*sin(al), -1/112*cos(al)^4]];

M{4}(:,:,3,3) = [[0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, cos(al)^2/28, 1/14*sin(2*al), 1/28*(1 - 3*cos(2*al)), -1/14*sin(2*al), cos(al)^2/28, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [cos(al)^4/112, 1/14*cos(al)^3*sin(al), -1/56*cos(al)^2*(-5 + 7*cos(2*al)), -1/56*(-1 + 7*cos(2*al))*sin(2*al), 1/448*(9 - 20*cos(2*al) + 35*cos(4*al)), 1/56*(-1 + 7*cos(2*al))*sin(2*al), -1/56*cos(al)^2*(-5 + 7*cos(2*al)), -1/14*cos(al)^3*sin(al), cos(al)^4/112]];

M{3}(:,:,1,4) = [[0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0]; [-1/8*cos(al)^3, -3/4*cos(al)^2*sin(al), -3/32*(cos(al) - 5*cos(3*al)), 1/8*(-3*sin(al) + 5*sin(3*al)), 3/32*(cos(al) - 5*cos(3*al)), -3/4*cos(al)^2*sin(al), cos(al)^3/8]];

M{4}(:,:,2,4) = [[0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [cos(al)^4/64, 1/8*cos(al)^3*sin(al), -1/32*cos(al)^2*(-5 + 7*cos(2*al)), 1/64*(2*sin(2*al) - 7*sin(4*al)), 1/256*(9 - 20*cos(2*al) + 35*cos(4*al)), 1/64*(-2*sin(2*al) + 7*sin(4*al)), -1/32*cos(al)^2*(-5 + 7*cos(2*al)), -1/8*cos(al)^3*sin(al), cos(al)^4/64]];

M{4}(:,:,1,5) = [[0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [0, 0, 0, 0, 0, 0, 0, 0, 0]; [cos(al)^4/16, 1/2*cos(al)^3*sin(al), -1/8*cos(al)^2*(-5 + 7*cos(2*al)), 1/16*(2*sin(2*al) - 7*sin(4*al)), 1/64*(9 - 20*cos(2*al) + 35*cos(4*al)), 1/16*(-2*sin(2*al) + 7*sin(4*al)), -1/8*cos(al)^2*(-5 + 7*cos(2*al)), -1/2*cos(al)^3*sin(al), cos(al)^4/16]];

